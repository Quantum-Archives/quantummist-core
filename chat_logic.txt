# ğŸ“˜ CHAT_LOGIC.md â€“ Logika czatu QuantumMist

## ğŸ¯ Cel
Opis logiki dziaÅ‚ania czatu uÅ¼ytkownika z administratorem w QuantumMist, ze wsparciem dla:
- historii wiadomoÅ›ci
- reakcji pod wiadomoÅ›ciami
- cytowania fragmentÃ³w
- wersji roboczych wiadomoÅ›ci
- zapisywania â€na potemâ€
- planowanych funkcji przesyÅ‚ania plikÃ³w (grafika/wideo)

---

## ğŸ§± Struktura komponentÃ³w (frontend)

### ğŸªŸ `#chat-container`
- GÅ‚Ã³wny kontener czatu
- Stylizowany jako 520x620px (13 x 15,5cm)

### ğŸ’¬ `#chat-messages`
- Kontener na wiadomoÅ›ci
- KaÅ¼da wiadomoÅ›Ä‡ jako osobny `div` z ID (np. `msg-1831`)
- WewnÄ…trz: treÅ›Ä‡, metadane, reakcje

### ğŸ–Šï¸ `#chat-draft`
- `textarea` do pisania wiadomoÅ›ci
- ObsÅ‚uguje localStorage (wersje robocze)

### ğŸ”˜ Przycisk â€WyÅ›lijâ€
- WywoÅ‚uje `sendMessage()` â†’ wysyÅ‚a do backendu

### ğŸ’¾ Przycisk â€Zapisz na potemâ€
- WywoÅ‚uje `saveDraft()`
- Zapisuje aktualnÄ… wiadomoÅ›Ä‡ w localStorage z timestampem

### ğŸ”„ Cytowanie (quote)
- KaÅ¼da wiadomoÅ›Ä‡ ma przycisk `"Cytuj"`
- KlikniÄ™cie wstawia cytat do drafta i pokazuje podglÄ…d cytowanego fragmentu (`#quote-preview`)

### ğŸ’Ÿ Reakcje
- Reakcje dostÄ™pne po najechaniu na wiadomoÅ›Ä‡ (ikony: ğŸ‘, ğŸ’¡, ğŸŒ€)
- KlikniÄ™cie wysyÅ‚a `POST /chat/react` z ID wiadomoÅ›ci
- Frontend zapisuje lokalnie + sync z backendem

---

## ğŸ’¾ Backend (plan minimum viable API)

### `POST /chat/send`
- Dane: `{ "user_id": ..., "message": "...", "quote": optional }`
- OdpowiedÅº: `{ status: ok, message_id: ... }`

### `GET /chat/history?user_id=...`
- Zwraca historiÄ™ rozmowy uÅ¼ytkownika

### `POST /chat/react`
- `{ message_id, reaction_type }`
- Zapisuje reakcjÄ™ do DB / JSON pliku

---

## ğŸ§  PrzyszÅ‚e funkcje (sloty planowane)
- `POST /chat/media_upload` â€“ przesyÅ‚anie plikÃ³w (tylko zaufani)
- `GET /chat/drafts` â€“ lista wersji roboczych
- `POST /chat/save_to_journal` â€“ eksport rozmowy do dziennika uÅ¼ytkownika

---

## ğŸ”Œ Punkty podpiÄ™cia
- **`#user_panel_hook`** â†’ slot profilu, preferencji i dostÄ™pu
- **`#dev_journal_captures`** â†’ przycisk eksportu do kanwy

## âœ… Status
Plik aktywny. Gotowy do powiÄ…zania z backendem i rozwijania.
